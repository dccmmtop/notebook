---
title: Mongo创建文档 
date: 2021-09-05 17:46:38
tags: [mongoDB]
---

## 插入并保存文档
```shell
db.foo.insert({"bar": "baz"})
```
这个操作会给文档自动增加一个"_id"键（要是原来没有的话），然后将其保存到MongoDB中。

## 批量插入
如果要向集合中插入多个文档，使用批量插入会快一些。使用批量插入，可以将一组文档传递给数据库。
在shell中，可以使用batchInsert函数实现批量插入，它与insert函数非常像，只是它接受的是一个文档数组作为参数：

```shell
db.foo.batchInsert([{"_id": 1},{"_id": 2}, {"_id": 3}])
```
要是只导入原始数据（例如，从数据feed或者MySQL中导入），可以使用命令行工具，如mongoimport，而不是批量插入

当前版本的MongoDB能接受的最大消息长度是48 MB，所以在一次批量插入中能插入的文档是有限制的。如果试图插入48 MB以上的数据，多数驱动程序会将这个批量插入请求拆分为多个48 MB的批量插入请求。具体可以查看所使用的驱动程序的相关文档。

如果在执行批量插入的过程中有一个文档插入失败，那么在这个文档之前的所有文档都会成功插入到集合中，而这个文档以及之后的所有文档全部插入失败。

在批量插入中遇到错误时，如果希望batchInsert忽略错误并且继续执行后续插入，可以使用continueOnError选项

## 插入校验
- 检查文档的基本结构，如果没有"_id"字段，就自动增加一个。
- 所有文档都必须小于16 MB（这个值是MongoDB设计者人为定的，未来有可能会增加）。作这样的限制主要是为了防止不良的模式设计，并且保证性能一致