# 节假日判断
```ruby
require "json"
require "date"
class Holiday
  def self.events
    Rails.cache.fetch("holiday_info") do
      begin
        info = JSON.parse(File.read(holidays_json_path))
      rescue => e
        Rails.logger.error("读取节假日信息失败，请更换 #{holidays_json_path} 文件")
        Rails.logger.error(e.message)
        raise
      end
      event = {}
      info.each do |holiday|
        (Date.parse(holiday["range"].first) .. Date.parse(holiday["range"].last)).each do |date|
          date = date.to_s
          event[date] ||= {}
          event[date]["name"] = holiday["name"]
          event[date]["type"] = holiday["type"]
        end
      end
      event
    end

  end

  def self.is_holiday?(time)
    date = time.strftime("%Y-%m-%d")
    if events[date] && events[date]["type"] == "holiday"
      return true
    end
    is_weekend =  [0,6].include?(time.wday)
    if is_weekend && !(events[date] && events[date]["type"] == "workingday")
      return true
    end
    return false
  end

  def self.holidays_json_path
    "#{Rails.root}/config/holidays.json"
  end

end

```
节假日信息获取处
[github](https://github.com/bastengao/chinese-holidays-ruby/tree/master/lib/chinese/holidays/data)

![](_blog_images/20200621082708084_44351907.png)